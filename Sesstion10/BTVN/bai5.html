<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <script>
        let teamHistory = [
            {
                name: "Messi",
                position: "Forward",
                nationality: "Argentina",
                seasons: {
                    "2022-2023": { matches: 34, goals: 21, assists: 14, yellowCards: 3 },
                    "2023-2024": { matches: 32, goals: 25, assists: 15, yellowCards: 2 },
                    "2024-2025": { matches: 28, goals: 18, assists: 12, yellowCards: 1 },
                },
            },
            {
                name: "Ronaldo",
                position: "Forward",
                nationality: "Portugal",
                seasons: {
                    "2022-2023": { matches: 38, goals: 28, assists: 8, yellowCards: 5 },
                    "2023-2024": { matches: 35, goals: 30, assists: 10, yellowCards: 4 },
                    "2024-2025": { matches: 30, goals: 22, assists: 9, yellowCards: 3 },
                },
            },
        ];

        function generatePlayerSeasonReport(playerName, history) {
            let player = history.find(p => p.name === playerName);

            if (!player) {
                return "Không tìm thấy cầu thủ " + playerName;
            }

            let tMatches = 0;
            let tGoals = 0;
            let tAssists = 0;
            let tYellow = 0;
            
            let bestName = "";
            let bestInfo = null;

            for (let year in player.seasons) {
                let stats = player.seasons[year];

                tMatches = tMatches + stats.matches;
                tGoals = tGoals + stats.goals;
                tAssists = tAssists + stats.assists;
                tYellow = tYellow + stats.yellowCards;

                if (!bestInfo || stats.goals > bestInfo.goals || (stats.goals === bestInfo.goals && stats.assists > bestInfo.assists)) {
                    bestInfo = stats;
                    bestName = year;
                }
            }

            return {
                name: player.name,
                position: player.position,
                nationality: player.nationality,
                careerStats: {
                    totalMatches: tMatches,
                    totalGoals: tGoals,
                    totalAssists: tAssists,
                    totalYellowCards: tYellow,
                    averageGoalsPerMatch: +(tGoals / tMatches).toFixed(2),
                    averageAssistsPerMatch: +(tAssists / tMatches).toFixed(2),
                    bestSeason: {
                        season: bestName,
                        goals: bestInfo.goals,
                        assists: bestInfo.assists
                    }
                }
            };
        }

        console.log(generatePlayerSeasonReport("Messi", teamHistory));
    </script>
</body>
</html>